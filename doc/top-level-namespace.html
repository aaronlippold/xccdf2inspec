<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Top Level Namespace
  
    &mdash; Documentation by YARD 0.9.8
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index</a> &raquo;
    
    
    <span class="title">Top Level Namespace</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Top Level Namespace
  
  
  
</h1>
<div class="box_info">
  

  
  
  
  
  

  

  
</div>








  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#get_benchmark_info-instance_method" title="#get_benchmark_info (instance method)">#<strong>get_benchmark_info</strong>(xccdf_file)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Finds the XCCDF Benchmark information and returns a hash of the the title,
release version,release date,desc,version,publisher,source,href version and
release date.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#get_impact-instance_method" title="#get_impact (instance method)">#<strong>get_impact</strong>(severity)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>&#39;impact&#39; level.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#get_nist_reference-instance_method" title="#get_nist_reference (instance method)">#<strong>get_nist_reference</strong>(cci_file, cci_number)  &#x21d2; Array&lt;String&gt;<sup>?</sup> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>An array containing the CCI Control Number and the version of the NIST
800-53 Revision the Control identifer is published in.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#print_benchmark_info-instance_method" title="#print_benchmark_info (instance method)">#<strong>print_benchmark_info</strong>(info)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>calls <span class='object_link'><a href="top-level-namespace.html#get_benchmark_info-instance_method" title="#get_benchmark_info (method)">#get_benchmark_info</a></span> Prints XCCDF Benchmark information for easy
reading.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#print_benchmark_into-instance_method" title="#print_benchmark_into (instance method)">#<strong>print_benchmark_into</strong>(xccdf)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>calls <span class='object_link'><a href="top-level-namespace.html#get_benchmark_info-instance_method" title="#get_benchmark_info (method)">#get_benchmark_info</a></span> Prints XCCDF Benchmark information for easy
reading.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#reformat_wrapped-instance_method" title="#reformat_wrapped (instance method)">#<strong>reformat_wrapped</strong>(string, width)  &#x21d2; &lt;String&gt; </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Reformats a given string to a defined word-wrapped width
<a href="https://goo.gl/MWE3yl" target="_parent" title="https://goo.gl/MWE3yl">https://goo.gl/MWE3yl</a>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#xccdf_to_inspec-instance_method" title="#xccdf_to_inspec (instance method)">#<strong>xccdf_to_inspec</strong>(file, cci_file, group, out, output_format)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Parses the XCCDF file and generates the inspec control stubs.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="get_benchmark_info-instance_method">
  
    #<strong>get_benchmark_info</strong>(xccdf_file)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Finds the XCCDF Benchmark information and returns a hash of the the title,
release version,release date,desc,version,publisher,source,href version and
release date.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>xccdf_file</span>
      
      
        <span class='type'>(<tt>FileHandle</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the xccdf file you are processing</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'xccdf2inspec.rb', line 138</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_benchmark_info'>get_benchmark_info</span><span class='lparen'>(</span><span class='id identifier rubyid_xccdf_file'>xccdf_file</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_benchmark_info'>benchmark_info</span> <span class='op'>=</span>
    <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>title</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>desc</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>release_date</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>version</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>status</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>publisher</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>source</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>href</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
    <span class='rparen'>)</span>
  <span class='id identifier rubyid_benchmark_info'>benchmark_info</span><span class='lbracket'>[</span><span class='symbol'>:title</span><span class='rbracket'>]</span> <span class='op'>=</span>
    <span class='id identifier rubyid_xccdf_file'>xccdf_file</span><span class='period'>.</span><span class='id identifier rubyid_xpath'>xpath</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>//Benchmark/title</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_text'>text</span>
  <span class='id identifier rubyid_benchmark_info'>benchmark_info</span><span class='lbracket'>[</span><span class='symbol'>:desc</span><span class='rbracket'>]</span> <span class='op'>=</span>
    <span class='id identifier rubyid_xccdf_file'>xccdf_file</span><span class='period'>.</span><span class='id identifier rubyid_xpath'>xpath</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>//Benchmark/description</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_text'>text</span>
  <span class='id identifier rubyid_benchmark_info'>benchmark_info</span><span class='lbracket'>[</span><span class='symbol'>:version</span><span class='rbracket'>]</span> <span class='op'>=</span>
    <span class='id identifier rubyid_xccdf_file'>xccdf_file</span><span class='period'>.</span><span class='id identifier rubyid_xpath'>xpath</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>//Benchmark/version</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_text'>text</span>
  <span class='id identifier rubyid_benchmark_info'>benchmark_info</span><span class='lbracket'>[</span><span class='symbol'>:release_date</span><span class='rbracket'>]</span> <span class='op'>=</span>
    <span class='id identifier rubyid_xccdf_file'>xccdf_file</span><span class='period'>.</span><span class='id identifier rubyid_xpath'>xpath</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>//Benchmark/status/@date</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_text'>text</span>
  <span class='id identifier rubyid_benchmark_info'>benchmark_info</span><span class='lbracket'>[</span><span class='symbol'>:status</span><span class='rbracket'>]</span> <span class='op'>=</span>
    <span class='id identifier rubyid_xccdf_file'>xccdf_file</span><span class='period'>.</span><span class='id identifier rubyid_xpath'>xpath</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>//Benchmark/status</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_text'>text</span>
  <span class='id identifier rubyid_benchmark_info'>benchmark_info</span><span class='lbracket'>[</span><span class='symbol'>:publisher</span><span class='rbracket'>]</span> <span class='op'>=</span>
    <span class='id identifier rubyid_xccdf_file'>xccdf_file</span><span class='period'>.</span><span class='id identifier rubyid_xpath'>xpath</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>//Benchmark/reference/publisher</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_text'>text</span>
  <span class='id identifier rubyid_benchmark_info'>benchmark_info</span><span class='lbracket'>[</span><span class='symbol'>:source</span><span class='rbracket'>]</span> <span class='op'>=</span>
    <span class='id identifier rubyid_xccdf_file'>xccdf_file</span><span class='period'>.</span><span class='id identifier rubyid_xpath'>xpath</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>//Benchmark/reference/source</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_text'>text</span>
  <span class='id identifier rubyid_benchmark_info'>benchmark_info</span><span class='lbracket'>[</span><span class='symbol'>:href</span><span class='rbracket'>]</span> <span class='op'>=</span>
    <span class='id identifier rubyid_xccdf_file'>xccdf_file</span><span class='period'>.</span><span class='id identifier rubyid_xpath'>xpath</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>//Benchmark/reference/@href</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_text'>text</span>

  <span class='id identifier rubyid_benchmark_info'>benchmark_info</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_impact-instance_method">
  
    #<strong>get_impact</strong>(severity)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note todo">
    <strong>TODO:</strong>
    <div class='inline'>
<p>Allow for the user to pass in a hash for the desired mapping of text</p>
</div>
  </div>


<p>&#39;impact&#39; level.</p>

<p>mapped to a float between 0.0 - 1.0.</p>

<p>values to numbers or to override our hard coded values.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>severity</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the string value you want to map to an InSpec</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


233
234
235
236
237
238
239
240
241</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'xccdf2inspec.rb', line 233</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_impact'>get_impact</span><span class='lparen'>(</span><span class='id identifier rubyid_severity'>severity</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_impact'>impact</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_impact'>impact</span> <span class='op'>=</span> <span class='kw'>case</span> <span class='id identifier rubyid_severity'>severity</span>
           <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>low</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>then</span> <span class='float'>0.3</span>
           <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>medium</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>then</span> <span class='float'>0.5</span>
           <span class='kw'>else</span> <span class='float'>0.7</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_impact'>impact</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_nist_reference-instance_method">
  
    #<strong>get_nist_reference</strong>(cci_file, cci_number)  &#x21d2; <tt>Array&lt;String&gt;</tt><sup>?</sup> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note todo">
    <strong>TODO:</strong>
    <div class='inline'>
<p>account for the case when we don&#39;t find the CCI passed in, we should
return nil. i.e. use the #status var.</p>
</div>
  </div>


<p>Returns an array containing the CCI Control Number and the version of the
NIST 800-53 Revision the Control identifer is published in.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>cci_file</span>
      
      
        <span class='type'>(<tt>FileHandle</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the open file handle of the disa cci xml</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>cci_number</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the CCI number you are using to query the xml</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;String&gt;</tt>, <tt>nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>an array containing the CCI Control Number and the version of the NIST
800-53 Revision the Control identifer is published in.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


208
209
210
211
212
213
214
215</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'xccdf2inspec.rb', line 208</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_nist_reference'>get_nist_reference</span><span class='lparen'>(</span><span class='id identifier rubyid_cci_file'>cci_file</span><span class='comma'>,</span> <span class='id identifier rubyid_cci_number'>cci_number</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_nist_ref'>nist_ref</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_nist_ver'>nist_ver</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_item_node'>item_node</span> <span class='op'>=</span> <span class='id identifier rubyid_cci_file'>cci_file</span><span class='period'>.</span><span class='id identifier rubyid_xpath'>xpath</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>//cci_list/cci_items/cci_item[@id=&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_cci_number'>cci_number</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;]</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_nist_ref'>nist_ref</span> <span class='op'>=</span> <span class='id identifier rubyid_item_node'>item_node</span><span class='period'>.</span><span class='id identifier rubyid_xpath'>xpath</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>./references/reference[not(@version &lt;= preceding-sibling::reference/@version) and not(@version &lt;=following-sibling::reference/@version)]/@index</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_text'>text</span>
  <span class='id identifier rubyid_nist_ver'>nist_ver</span> <span class='op'>=</span> <span class='id identifier rubyid_item_node'>item_node</span><span class='period'>.</span><span class='id identifier rubyid_xpath'>xpath</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>./references/reference[not(@version &lt;= preceding-sibling::reference/@version) and not(@version &lt;=following-sibling::reference/@version)]/@version</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_text'>text</span>
  <span class='lbracket'>[</span><span class='id identifier rubyid_nist_ref'>nist_ref</span><span class='comma'>,</span> <span class='id identifier rubyid_nist_ver'>nist_ver</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="print_benchmark_info-instance_method">
  
    #<strong>print_benchmark_info</strong>(info)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>calls <span class='object_link'><a href="#get_benchmark_info-instance_method" title="#get_benchmark_info (method)">#get_benchmark_info</a></span> Prints XCCDF Benchmark information for easy
reading</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>xccdf</span>
      
      
        <span class='type'>(<tt>FileHandle</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the XCCDF file you want to print info about</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'xccdf2inspec.rb', line 177</span>

<span class='kw'>def</span> <span class='id identifier rubyid_print_benchmark_into'><span class='object_link'><a href="#print_benchmark_into-instance_method" title="#print_benchmark_into (method)">print_benchmark_into</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_xccdf'>xccdf</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_info'>info</span> <span class='op'>=</span> <span class='id identifier rubyid_get_benchmark_info'><span class='object_link'><a href="#get_benchmark_info-instance_method" title="#get_benchmark_info (method)">get_benchmark_info</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_xccdf'>xccdf</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_benchmark_info'>benchmark_info</span> <span class='op'>=</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>=begin</span><span class='tstring_end'>&#39;</span></span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span> \
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>-----------------</span><span class='tstring_end'>&#39;</span></span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span> \
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Benchmark: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_info'>info</span><span class='lbracket'>[</span><span class='symbol'>:title</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>  \n</span><span class='tstring_end'>&quot;</span></span> \
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Status: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_info'>info</span><span class='lbracket'>[</span><span class='symbol'>:status</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_capitalize'>capitalize</span><span class='embexpr_end'>}</span><span class='tstring_content'> \n\n</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span>
    <span class='id identifier rubyid_reformat_wrapped'><span class='object_link'><a href="#reformat_wrapped-instance_method" title="#reformat_wrapped (method)">reformat_wrapped</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_info'>info</span><span class='lbracket'>[</span><span class='symbol'>:desc</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_width'>width</span> <span class='op'>=</span> <span class='int'>78</span><span class='rparen'>)</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n\n</span><span class='tstring_end'>&quot;</span></span> \
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Release Date: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_info'>info</span><span class='lbracket'>[</span><span class='symbol'>:release_date</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'> \n</span><span class='tstring_end'>&quot;</span></span> \
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Version: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_info'>info</span><span class='lbracket'>[</span><span class='symbol'>:version</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'> \n</span><span class='tstring_end'>&quot;</span></span> \
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Publisher: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_info'>info</span><span class='lbracket'>[</span><span class='symbol'>:publisher</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'> \n</span><span class='tstring_end'>&quot;</span></span> \
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Source: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_info'>info</span><span class='lbracket'>[</span><span class='symbol'>:source</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'> \n</span><span class='tstring_end'>&quot;</span></span> \
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>uri: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_info'>info</span><span class='lbracket'>[</span><span class='symbol'>:href</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'> \n</span><span class='tstring_end'>&quot;</span></span> \
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>----------------- \n</span><span class='tstring_end'>&quot;</span></span> \
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>=end \n\n</span><span class='tstring_end'>&quot;</span></span>

  <span class='id identifier rubyid_benchmark_info'>benchmark_info</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="print_benchmark_into-instance_method">
  
    #<strong>print_benchmark_into</strong>(xccdf)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>calls <span class='object_link'><a href="#get_benchmark_info-instance_method" title="#get_benchmark_info (method)">#get_benchmark_info</a></span> Prints XCCDF Benchmark information for easy
reading</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>xccdf</span>
      
      
        <span class='type'>(<tt>FileHandle</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the XCCDF file you want to print info about</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'xccdf2inspec.rb', line 177</span>

<span class='kw'>def</span> <span class='id identifier rubyid_print_benchmark_into'>print_benchmark_into</span><span class='lparen'>(</span><span class='id identifier rubyid_xccdf'>xccdf</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_info'>info</span> <span class='op'>=</span> <span class='id identifier rubyid_get_benchmark_info'><span class='object_link'><a href="#get_benchmark_info-instance_method" title="#get_benchmark_info (method)">get_benchmark_info</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_xccdf'>xccdf</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_benchmark_info'>benchmark_info</span> <span class='op'>=</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>=begin</span><span class='tstring_end'>&#39;</span></span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span> \
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>-----------------</span><span class='tstring_end'>&#39;</span></span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span> \
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Benchmark: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_info'>info</span><span class='lbracket'>[</span><span class='symbol'>:title</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>  \n</span><span class='tstring_end'>&quot;</span></span> \
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Status: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_info'>info</span><span class='lbracket'>[</span><span class='symbol'>:status</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_capitalize'>capitalize</span><span class='embexpr_end'>}</span><span class='tstring_content'> \n\n</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span>
    <span class='id identifier rubyid_reformat_wrapped'><span class='object_link'><a href="#reformat_wrapped-instance_method" title="#reformat_wrapped (method)">reformat_wrapped</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_info'>info</span><span class='lbracket'>[</span><span class='symbol'>:desc</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_width'>width</span> <span class='op'>=</span> <span class='int'>78</span><span class='rparen'>)</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n\n</span><span class='tstring_end'>&quot;</span></span> \
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Release Date: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_info'>info</span><span class='lbracket'>[</span><span class='symbol'>:release_date</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'> \n</span><span class='tstring_end'>&quot;</span></span> \
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Version: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_info'>info</span><span class='lbracket'>[</span><span class='symbol'>:version</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'> \n</span><span class='tstring_end'>&quot;</span></span> \
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Publisher: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_info'>info</span><span class='lbracket'>[</span><span class='symbol'>:publisher</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'> \n</span><span class='tstring_end'>&quot;</span></span> \
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Source: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_info'>info</span><span class='lbracket'>[</span><span class='symbol'>:source</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'> \n</span><span class='tstring_end'>&quot;</span></span> \
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>uri: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_info'>info</span><span class='lbracket'>[</span><span class='symbol'>:href</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'> \n</span><span class='tstring_end'>&quot;</span></span> \
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>----------------- \n</span><span class='tstring_end'>&quot;</span></span> \
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>=end \n\n</span><span class='tstring_end'>&quot;</span></span>

  <span class='id identifier rubyid_benchmark_info'>benchmark_info</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="reformat_wrapped-instance_method">
  
    #<strong>reformat_wrapped</strong>(string, width)  &#x21d2; <tt>&lt;String&gt;</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Reformats a given string to a defined word-wrapped width
<a href="https://goo.gl/MWE3yl" target="_parent" title="https://goo.gl/MWE3yl">https://goo.gl/MWE3yl</a></p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>string</span>
      
      
        <span class='type'>(<tt>&lt;String&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the string to be wrapped</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>width</span>
      
      
        <span class='type'>(<tt>&lt;Integer&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the width that the string will be wrapped to</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>&lt;String&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the line-wrapped string</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'xccdf2inspec.rb', line 113</span>

<span class='kw'>def</span> <span class='id identifier rubyid_reformat_wrapped'>reformat_wrapped</span><span class='lparen'>(</span><span class='id identifier rubyid_string'>string</span><span class='comma'>,</span> <span class='id identifier rubyid_width'>width</span> <span class='op'>=</span> <span class='int'>78</span><span class='rparen'>)</span>
<span class='id identifier rubyid_lines'>lines</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
<span class='id identifier rubyid_line'>line</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_string'>string</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\s+</span><span class='regexp_end'>/</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_word'>word</span><span class='op'>|</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_line'>line</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>+</span> <span class='id identifier rubyid_word'>word</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>&gt;=</span> <span class='id identifier rubyid_width'>width</span>
    <span class='id identifier rubyid_lines'>lines</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_line'>line</span>
    <span class='id identifier rubyid_line'>line</span> <span class='op'>=</span> <span class='id identifier rubyid_word'>word</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_line'>line</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='id identifier rubyid_line'>line</span> <span class='op'>=</span> <span class='id identifier rubyid_word'>word</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_line'>line</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> </span><span class='tstring_end'>&#39;</span></span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_word'>word</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
<span class='id identifier rubyid_lines'>lines</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_line'>line</span> <span class='kw'>if</span> <span class='id identifier rubyid_line'>line</span>
<span class='id identifier rubyid_lines'>lines</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="xccdf_to_inspec-instance_method">
  
    #<strong>xccdf_to_inspec</strong>(file, cci_file, group, out, output_format)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note todo">
    <strong>TODO:</strong>
    <div class='inline'>
<p>update the method to use the InSpec Profile object when it is written</p>
</div>
  </div>

  <div class="note todo">
    <strong>TODO:</strong>
    <div class='inline'>
<p>update the method to parse out the &#39;ref&#39; data for the XCCDF
document</p>
</div>
  </div>

  <div class="note todo">
    <strong>TODO:</strong>
    <div class='inline'>
<p>update the method to also generate the higher level dirs and xml for</p>
</div>
  </div>


<p>Parses the XCCDF file and generates the inspec control stubs. process from
the xccdf file, or &#39;nil&#39; means you want to process them all.
&#39;nil&#39; then it writes to $stdout. and tringgering which
&#39;to_*&#39; method is called in the inspec objects for the final output
format of the controls.</p>

<p>prints out to either a file handle or to $stdout</p>

<p>the profile - i.e. the inspec.yaml file, controls directory etc.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>file</span>
      
      
        <span class='type'>(<tt>FileHandle</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The XCCDF file you want to parse</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>cci_file</span>
      
      
        <span class='type'>(<tt>FileHandle</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The CCI XML file</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>group</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A csv list of the groups - i.e. controls - you want to</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>out</span>
      
      
        <span class='type'>(<tt>FileHandle</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The file that you want to write your output to, if</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>output_format</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A string that contains either &#39;ruby&#39; or &#39;hash&#39;</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'xccdf2inspec.rb', line 263</span>

<span class='kw'>def</span> <span class='id identifier rubyid_xccdf_to_inspec'>xccdf_to_inspec</span><span class='lparen'>(</span><span class='id identifier rubyid_xccdf_f'>xccdf_f</span><span class='comma'>,</span> <span class='id identifier rubyid_cci_f'>cci_f</span><span class='comma'>,</span> <span class='id identifier rubyid_group'>group</span><span class='comma'>,</span> <span class='id identifier rubyid_out'>out</span><span class='comma'>,</span> <span class='id identifier rubyid_output_format'>output_format</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_group'>group</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='id identifier rubyid_benchmark_xpath'>benchmark_xpath</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>//Benchmark/Group</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_string'>string</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>[@id=</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_values'>values</span> <span class='op'>=</span> <span class='id identifier rubyid_group'>group</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>,</span><span class='regexp_end'>/</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_values'>values</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_v'>v</span><span class='op'>|</span>
      <span class='id identifier rubyid_string'>string</span> <span class='op'>&lt;&lt;</span> <span class='kw'>if</span> <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_equal?'>equal?</span> <span class='id identifier rubyid_values'>values</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span>
                  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&#39;</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&#39;]</span><span class='tstring_end'>&quot;</span></span>
                <span class='kw'>else</span>
                  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&#39;</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&#39;or @id=</span><span class='tstring_end'>&quot;</span></span>
                <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_benchmark_xpath'>benchmark_xpath</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>//Benchmark/Group</span><span class='tstring_end'>&#39;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_string'>string</span>
    <span class='kw'>end</span>

  <span class='id identifier rubyid_xccdf_f'>xccdf_f</span><span class='period'>.</span><span class='id identifier rubyid_xpath'>xpath</span><span class='lparen'>(</span><span class='id identifier rubyid_benchmark_xpath'>benchmark_xpath</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_node'>node</span><span class='op'>|</span>
    <span class='id identifier rubyid_control'>control</span> <span class='op'>=</span> <span class='const'>Inspec</span><span class='op'>::</span><span class='const'>Control</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
    <span class='id identifier rubyid_control'>control</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span> <span class='op'>=</span> <span class='id identifier rubyid_node'>node</span><span class='period'>.</span><span class='id identifier rubyid_xpath'>xpath</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>./@id</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_text'>text</span>
    <span class='id identifier rubyid_control'>control</span><span class='period'>.</span><span class='id identifier rubyid_impact'>impact</span> <span class='op'>=</span> <span class='id identifier rubyid_get_impact'><span class='object_link'><a href="#get_impact-instance_method" title="#get_impact (method)">get_impact</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_node'>node</span><span class='period'>.</span><span class='id identifier rubyid_xpath'>xpath</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>./Rule/@severity</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_text'>text</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_control'>control</span><span class='period'>.</span><span class='id identifier rubyid_add_tag'>add_tag</span><span class='lparen'>(</span><span class='const'>Inspec</span><span class='op'>::</span><span class='const'>Tag</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>severity</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_node'>node</span><span class='period'>.</span><span class='id identifier rubyid_xpath'>xpath</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>./Rule/@severity</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_text'>text</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='comment'># control.add_newline (nice to have @chris-rock)
</span>    <span class='id identifier rubyid_control'>control</span><span class='period'>.</span><span class='id identifier rubyid_add_tag'>add_tag</span><span class='lparen'>(</span><span class='const'>Inspec</span><span class='op'>::</span><span class='const'>Tag</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>gtitle</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_node'>node</span><span class='period'>.</span><span class='id identifier rubyid_xpath'>xpath</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>./title</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_text'>text</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_control'>control</span><span class='period'>.</span><span class='id identifier rubyid_add_tag'>add_tag</span><span class='lparen'>(</span><span class='const'>Inspec</span><span class='op'>::</span><span class='const'>Tag</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>gid</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_node'>node</span><span class='period'>.</span><span class='id identifier rubyid_xpath'>xpath</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>./@id</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_text'>text</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_control'>control</span><span class='period'>.</span><span class='id identifier rubyid_add_tag'>add_tag</span><span class='lparen'>(</span><span class='const'>Inspec</span><span class='op'>::</span><span class='const'>Tag</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rid</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_node'>node</span><span class='period'>.</span><span class='id identifier rubyid_xpath'>xpath</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>./Rule/@id</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_text'>text</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_control'>control</span><span class='period'>.</span><span class='id identifier rubyid_add_tag'>add_tag</span><span class='lparen'>(</span><span class='const'>Inspec</span><span class='op'>::</span><span class='const'>Tag</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>stig_id</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_node'>node</span><span class='period'>.</span><span class='id identifier rubyid_xpath'>xpath</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>./Rule/version</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_text'>text</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='comment'># control.add_newline (nice to have @chris-rock)
</span>    <span class='id identifier rubyid_node'>node</span><span class='period'>.</span><span class='id identifier rubyid_xpath'>xpath</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>./Rule/ident</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_cci_node'>cci_node</span><span class='op'>|</span>
      <span class='id identifier rubyid_nist'>nist</span><span class='comma'>,</span> <span class='id identifier rubyid_nist_rev'>nist_rev</span> <span class='op'>=</span> <span class='id identifier rubyid_get_nist_reference'><span class='object_link'><a href="#get_nist_reference-instance_method" title="#get_nist_reference (method)">get_nist_reference</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_cci_f'>cci_f</span><span class='comma'>,</span> <span class='id identifier rubyid_cci_node'>cci_node</span><span class='period'>.</span><span class='id identifier rubyid_text'>text</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_control'>control</span><span class='period'>.</span><span class='id identifier rubyid_add_tag'>add_tag</span><span class='lparen'>(</span><span class='const'>Inspec</span><span class='op'>::</span><span class='const'>Tag</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>cci</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_cci_node'>cci_node</span><span class='period'>.</span><span class='id identifier rubyid_text'>text</span><span class='rparen'>)</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_control'>control</span><span class='period'>.</span><span class='id identifier rubyid_add_tag'>add_tag</span><span class='lparen'>(</span><span class='const'>Inspec</span><span class='op'>::</span><span class='const'>Tag</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>nist</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='id identifier rubyid_nist'>nist</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Rev_</span><span class='tstring_end'>&#39;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_nist_rev'>nist_rev</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_control'>control</span><span class='period'>.</span><span class='id identifier rubyid_title'>title</span> <span class='op'>=</span> <span class='id identifier rubyid_node'>node</span><span class='period'>.</span><span class='id identifier rubyid_xpath'>xpath</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>./Rule/title</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_text'>text</span>
    <span class='comment'># @todo .gsub(/\&lt;.*?\&gt;/, &#39;&#39;) pulls out many of the sub-discussion tags that
</span>    <span class='comment'># are in the XCCDF, we need to determine if this is an issue or if - for
</span>    <span class='comment'># the most part - this data is unused.
</span>    <span class='comment'># @todo gsub(/.false/, &#39;.&#39;) pulls off the tailing .false text items that
</span>    <span class='comment'># come form the extra metadata &lt; &gt; that the other gsub removes. I am sure
</span>    <span class='comment'># there is a more eleagant way to do this but for now it works.
</span>    <span class='id identifier rubyid_control'>control</span><span class='period'>.</span><span class='id identifier rubyid_desc'>desc</span> <span class='op'>=</span> <span class='id identifier rubyid_node'>node</span><span class='period'>.</span><span class='id identifier rubyid_xpath'>xpath</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>./Rule/description</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_text'>text</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\&lt;.*?\&gt;</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>.false</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='comment'># control.add_newline (nice to have @chris-rock)
</span>    <span class='id identifier rubyid_control'>control</span><span class='period'>.</span><span class='id identifier rubyid_add_tag'>add_tag</span><span class='lparen'>(</span><span class='const'>Inspec</span><span class='op'>::</span><span class='const'>Tag</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>check</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_node'>node</span><span class='period'>.</span><span class='id identifier rubyid_xpath'>xpath</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>./Rule/check/check-content</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_text'>text</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='comment'># control.add_newline (nice to have @chris-rock)
</span>    <span class='id identifier rubyid_control'>control</span><span class='period'>.</span><span class='id identifier rubyid_add_tag'>add_tag</span><span class='lparen'>(</span><span class='const'>Inspec</span><span class='op'>::</span><span class='const'>Tag</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>fix</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_node'>node</span><span class='period'>.</span><span class='id identifier rubyid_xpath'>xpath</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>./Rule/fixtext</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_text'>text</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='comment'># @todo control.add_newline (nice to have @chris-rock)
</span>    <span class='comment'># @todo control.ref = my reference tags
</span>    <span class='comment'># control.add_newline (nice to have @chris-rock)
</span>    <span class='comment'># @todo control.add_footer (nice to have @chris-rock)
</span>    <span class='comment'># the idea is that it would append the default:
</span>    <span class='comment'># 	describe &#39; &#39; do&quot; + &quot;\n\n&quot;
</span>    <span class='comment'># 	end&quot; + &quot;\n\n&quot;
</span>    <span class='comment'># before the final &#39;end&#39; of each control
</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_output_format'>output_format</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hash</span><span class='tstring_end'>&#39;</span></span>
      <span class='id identifier rubyid_out'>out</span><span class='period'>.</span><span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_control'>control</span><span class='period'>.</span><span class='id identifier rubyid_to_hash'>to_hash</span>
      <span class='id identifier rubyid_out'>out</span><span class='period'>.</span><span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_out'>out</span><span class='period'>.</span><span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_control'>control</span><span class='period'>.</span><span class='id identifier rubyid_to_ruby'>to_ruby</span>
      <span class='id identifier rubyid_out'>out</span><span class='period'>.</span><span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span>
      <span class='comment'># out.puts &quot;  describe &#39; &#39; do&quot; + &quot;\n\n&quot;
</span>      <span class='comment'># out.puts &quot;  end&quot; + &quot;\n\n&quot;
</span>    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Sun Mar 26 19:06:57 2017 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.8 (ruby-2.4.0).
</div>

    </div>
  </body>
</html>